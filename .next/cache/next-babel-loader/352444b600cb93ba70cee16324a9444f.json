{"ast":null,"code":"import { useState, useEffect } from \"react\";\nimport Cookies from \"js-cookie\";\n\nfunction useLocalState(key, defaultValue) {\n  const {\n    0: value,\n    1: setValue\n  } = useState(() => {\n    if (false) {\n      const storedValue = JSON.parse(localStorage.getItem(key));\n\n      if (!storedValue) {\n        return defaultValue;\n      }\n\n      return storedValue === null ? defaultValue : storedValue;\n    } else {\n      return defaultValue;\n    }\n  });\n  useEffect(() => {\n    const listener = e => {\n      if (e.storageArea === localStorage && e.key === key) {\n        setValue(JSON.parse(e.newValue));\n        Cookies.set(JSON.parse(e.newValue));\n        console.log(JSON.parse(Cookies.get(key)));\n      }\n    };\n\n    window.addEventListener(\"storage\", listener);\n    return () => {\n      window.removeEventListener(\"storage\", listener);\n    };\n  }, [key]);\n\n  const setValueInLocalStorage = newValue => {\n    setValue(currentValue => {\n      if (typeof newValue != \"function\") {\n        Cookies.set(key, newValue);\n      }\n\n      const result = typeof newValue === \"function\" ? newValue(currentValue) : newValue;\n      localStorage.setItem(key, JSON.stringify(result));\n      return result;\n    });\n  };\n\n  useEffect(() => {\n    const storedValue = JSON.parse(localStorage.getItem(key));\n\n    if (storedValue) {\n      setValueInLocalStorage(storedValue);\n    } else {\n      setValueInLocalStorage(value);\n    }\n  }, []);\n  return [value, setValueInLocalStorage];\n}\n\nexport default useLocalState;","map":{"version":3,"sources":["/home/ishraqkabir/workspace/smartifier-frontend/custom-hooks/useLocalState.ts"],"names":["useState","useEffect","Cookies","useLocalState","key","defaultValue","value","setValue","storedValue","JSON","parse","localStorage","getItem","listener","e","storageArea","newValue","set","console","log","get","window","addEventListener","removeEventListener","setValueInLocalStorage","currentValue","result","setItem","stringify"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,OAAOC,OAAP,MAAoB,WAApB;;AAEA,SAASC,aAAT,CAA0BC,GAA1B,EAAuCC,YAAvC,EAAwD;AACtD,QAAM;AAAA,OAACC,KAAD;AAAA,OAAQC;AAAR,MAAoBP,QAAQ,CAAC,MAAM;AACvC,eAAqB;AACnB,YAAMQ,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBR,GAArB,CAAX,CAApB;;AACA,UAAI,CAACI,WAAL,EAAkB;AAChB,eAAOH,YAAP;AACD;;AACD,aAAOG,WAAW,KAAK,IAAhB,GAAuBH,YAAvB,GAAsCG,WAA7C;AACD,KAND,MAMO;AACL,aAAOH,YAAP;AACD;AACF,GAViC,CAAlC;AAYAJ,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMY,QAAQ,GAAIC,CAAD,IAAO;AACtB,UAAIA,CAAC,CAACC,WAAF,KAAkBJ,YAAlB,IAAkCG,CAAC,CAACV,GAAF,KAAUA,GAAhD,EAAqD;AACnDG,QAAAA,QAAQ,CAACE,IAAI,CAACC,KAAL,CAAWI,CAAC,CAACE,QAAb,CAAD,CAAR;AACAd,QAAAA,OAAO,CAACe,GAAR,CAAYR,IAAI,CAACC,KAAL,CAAWI,CAAC,CAACE,QAAb,CAAZ;AACAE,QAAAA,OAAO,CAACC,GAAR,CAAYV,IAAI,CAACC,KAAL,CAAWR,OAAO,CAACkB,GAAR,CAAYhB,GAAZ,CAAX,CAAZ;AACD;AACF,KAND;;AAOAiB,IAAAA,MAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmCT,QAAnC;AAEA,WAAO,MAAM;AACXQ,MAAAA,MAAM,CAACE,mBAAP,CAA2B,SAA3B,EAAsCV,QAAtC;AACD,KAFD;AAGD,GAbQ,EAaN,CAACT,GAAD,CAbM,CAAT;;AAeA,QAAMoB,sBAAsB,GAAIR,QAAD,IAAc;AAC3CT,IAAAA,QAAQ,CAAEkB,YAAD,IAAkB;AACzB,UAAI,OAAOT,QAAP,IAAmB,UAAvB,EAAmC;AACjCd,QAAAA,OAAO,CAACe,GAAR,CAAYb,GAAZ,EAAiBY,QAAjB;AACD;;AACD,YAAMU,MAAM,GACV,OAAOV,QAAP,KAAoB,UAApB,GAAiCA,QAAQ,CAACS,YAAD,CAAzC,GAA0DT,QAD5D;AAEAL,MAAAA,YAAY,CAACgB,OAAb,CAAqBvB,GAArB,EAA0BK,IAAI,CAACmB,SAAL,CAAeF,MAAf,CAA1B;AACA,aAAOA,MAAP;AACD,KARO,CAAR;AASD,GAVD;;AAYAzB,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMO,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBR,GAArB,CAAX,CAApB;;AACA,QAAII,WAAJ,EAAiB;AACfgB,MAAAA,sBAAsB,CAAChB,WAAD,CAAtB;AACD,KAFD,MAEO;AACLgB,MAAAA,sBAAsB,CAAClB,KAAD,CAAtB;AACD;AACF,GAPQ,EAON,EAPM,CAAT;AASA,SAAO,CAACA,KAAD,EAAQkB,sBAAR,CAAP;AACD;;AAED,eAAerB,aAAf","sourcesContent":["import { useState, useEffect } from \"react\";\nimport Cookies from \"js-cookie\";\n\nfunction useLocalState<T>(key: string, defaultValue: T) {\n  const [value, setValue] = useState(() => {\n    if (process.browser) {\n      const storedValue = JSON.parse(localStorage.getItem(key));\n      if (!storedValue) {\n        return defaultValue;\n      }\n      return storedValue === null ? defaultValue : storedValue;\n    } else {\n      return defaultValue;\n    }\n  });\n\n  useEffect(() => {\n    const listener = (e) => {\n      if (e.storageArea === localStorage && e.key === key) {\n        setValue(JSON.parse(e.newValue));\n        Cookies.set(JSON.parse(e.newValue));\n        console.log(JSON.parse(Cookies.get(key)));\n      }\n    };\n    window.addEventListener(\"storage\", listener);\n\n    return () => {\n      window.removeEventListener(\"storage\", listener);\n    };\n  }, [key]);\n\n  const setValueInLocalStorage = (newValue) => {\n    setValue((currentValue) => {\n      if (typeof newValue != \"function\") {\n        Cookies.set(key, newValue);\n      }\n      const result =\n        typeof newValue === \"function\" ? newValue(currentValue) : newValue;\n      localStorage.setItem(key, JSON.stringify(result));\n      return result;\n    });\n  };\n\n  useEffect(() => {\n    const storedValue = JSON.parse(localStorage.getItem(key));\n    if (storedValue) {\n      setValueInLocalStorage(storedValue);\n    } else {\n      setValueInLocalStorage(value);\n    }\n  }, []);\n\n  return [value, setValueInLocalStorage];\n}\n\nexport default useLocalState;\n"]},"metadata":{},"sourceType":"module"}