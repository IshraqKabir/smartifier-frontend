{"ast":null,"code":"import { useState, useEffect } from \"react\";\n\nfunction useLocalState(key, defaultValue) {\n  const {\n    0: value,\n    1: setValue\n  } = useState(() => {\n    if (false) {\n      const storedValue = JSON.parse(localStorage.getItem(key));\n\n      if (!storedValue) {\n        return defaultValue;\n      }\n\n      return storedValue === null ? defaultValue : storedValue;\n    } else {\n      return defaultValue;\n    }\n  });\n  useEffect(() => {\n    const listener = e => {\n      if (e.storageArea === localStorage && e.key === key) {\n        setValue(JSON.parse(e.newValue));\n        console.log(getCookie(\"\"));\n      }\n    };\n\n    window.addEventListener(\"storage\", listener);\n    return () => {\n      window.removeEventListener(\"storage\", listener);\n    };\n  }, [key]);\n\n  const setValueInLocalStorage = newValue => {\n    setValue(currentValue => {\n      const result = typeof newValue === \"function\" ? newValue(currentValue) : newValue;\n      localStorage.setItem(key, JSON.stringify(result));\n      return result;\n    });\n    setCookie(key, newValue);\n  };\n\n  useEffect(() => {\n    const storedValue = JSON.parse(localStorage.getItem(key));\n\n    if (storedValue) {\n      setValueInLocalStorage(storedValue);\n    } else {\n      setValueInLocalStorage(value);\n    }\n  }, []);\n\n  function setCookie(name, value, days = 99999999) {\n    var expires = \"\";\n\n    if (days) {\n      var date = new Date();\n      date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n      expires = \"; expires=\" + date.toUTCString();\n    }\n\n    document.cookie = name + \"=\" + (JSON.stringify(value) || \"\") + expires + \"; path=/\";\n  }\n\n  function getCookie(name) {\n    var nameEQ = name + \"=\";\n    var ca = document.cookie.split(\";\");\n\n    for (var i = 0; i < ca.length; i++) {\n      var c = ca[i];\n\n      while (c.charAt(0) == \" \") c = c.substring(1, c.length);\n\n      if (c.indexOf(nameEQ) == 0) return JSON.parse(c.substring(nameEQ.length, c.length));\n    }\n\n    return null;\n  }\n\n  function eraseCookie(name) {\n    document.cookie = name + \"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;\";\n  }\n\n  return [value, setValueInLocalStorage];\n}\n\nexport default useLocalState;","map":{"version":3,"sources":["/home/ishraqkabir/workspace/smartifier-frontend/custom-hooks/useLocalState.ts"],"names":["useState","useEffect","useLocalState","key","defaultValue","value","setValue","storedValue","JSON","parse","localStorage","getItem","listener","e","storageArea","newValue","console","log","getCookie","window","addEventListener","removeEventListener","setValueInLocalStorage","currentValue","result","setItem","stringify","setCookie","name","days","expires","date","Date","setTime","getTime","toUTCString","document","cookie","nameEQ","ca","split","i","length","c","charAt","substring","indexOf","eraseCookie"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;;AAEA,SAASC,aAAT,CAA0BC,GAA1B,EAAuCC,YAAvC,EAAwD;AACtD,QAAM;AAAA,OAACC,KAAD;AAAA,OAAQC;AAAR,MAAoBN,QAAQ,CAAC,MAAM;AACvC,eAAqB;AACnB,YAAMO,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBR,GAArB,CAAX,CAApB;;AACA,UAAI,CAACI,WAAL,EAAkB;AAChB,eAAOH,YAAP;AACD;;AACD,aAAOG,WAAW,KAAK,IAAhB,GAAuBH,YAAvB,GAAsCG,WAA7C;AACD,KAND,MAMO;AACL,aAAOH,YAAP;AACD;AACF,GAViC,CAAlC;AAYAH,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMW,QAAQ,GAAIC,CAAD,IAAO;AACtB,UAAIA,CAAC,CAACC,WAAF,KAAkBJ,YAAlB,IAAkCG,CAAC,CAACV,GAAF,KAAUA,GAAhD,EAAqD;AACnDG,QAAAA,QAAQ,CAACE,IAAI,CAACC,KAAL,CAAWI,CAAC,CAACE,QAAb,CAAD,CAAR;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAYC,SAAS,CAAC,EAAD,CAArB;AACD;AACF,KALD;;AAMAC,IAAAA,MAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmCR,QAAnC;AAEA,WAAO,MAAM;AACXO,MAAAA,MAAM,CAACE,mBAAP,CAA2B,SAA3B,EAAsCT,QAAtC;AACD,KAFD;AAGD,GAZQ,EAYN,CAACT,GAAD,CAZM,CAAT;;AAcA,QAAMmB,sBAAsB,GAAIP,QAAD,IAAc;AAC3CT,IAAAA,QAAQ,CAAEiB,YAAD,IAAkB;AACzB,YAAMC,MAAM,GACV,OAAOT,QAAP,KAAoB,UAApB,GAAiCA,QAAQ,CAACQ,YAAD,CAAzC,GAA0DR,QAD5D;AAEAL,MAAAA,YAAY,CAACe,OAAb,CAAqBtB,GAArB,EAA0BK,IAAI,CAACkB,SAAL,CAAeF,MAAf,CAA1B;AACA,aAAOA,MAAP;AACD,KALO,CAAR;AAOAG,IAAAA,SAAS,CAACxB,GAAD,EAAMY,QAAN,CAAT;AACD,GATD;;AAWAd,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMM,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqBR,GAArB,CAAX,CAApB;;AACA,QAAII,WAAJ,EAAiB;AACfe,MAAAA,sBAAsB,CAACf,WAAD,CAAtB;AACD,KAFD,MAEO;AACLe,MAAAA,sBAAsB,CAACjB,KAAD,CAAtB;AACD;AACF,GAPQ,EAON,EAPM,CAAT;;AASA,WAASsB,SAAT,CAAmBC,IAAnB,EAAyBvB,KAAzB,EAAgCwB,IAAI,GAAG,QAAvC,EAAiD;AAC/C,QAAIC,OAAO,GAAG,EAAd;;AACA,QAAID,IAAJ,EAAU;AACR,UAAIE,IAAI,GAAG,IAAIC,IAAJ,EAAX;AACAD,MAAAA,IAAI,CAACE,OAAL,CAAaF,IAAI,CAACG,OAAL,KAAiBL,IAAI,GAAG,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,IAApD;AACAC,MAAAA,OAAO,GAAG,eAAeC,IAAI,CAACI,WAAL,EAAzB;AACD;;AACDC,IAAAA,QAAQ,CAACC,MAAT,GACET,IAAI,GAAG,GAAP,IAAcpB,IAAI,CAACkB,SAAL,CAAerB,KAAf,KAAyB,EAAvC,IAA6CyB,OAA7C,GAAuD,UADzD;AAED;;AAED,WAASZ,SAAT,CAAmBU,IAAnB,EAAyB;AACvB,QAAIU,MAAM,GAAGV,IAAI,GAAG,GAApB;AACA,QAAIW,EAAE,GAAGH,QAAQ,CAACC,MAAT,CAAgBG,KAAhB,CAAsB,GAAtB,CAAT;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,EAAE,CAACG,MAAvB,EAA+BD,CAAC,EAAhC,EAAoC;AAClC,UAAIE,CAAC,GAAGJ,EAAE,CAACE,CAAD,CAAV;;AACA,aAAOE,CAAC,CAACC,MAAF,CAAS,CAAT,KAAe,GAAtB,EAA2BD,CAAC,GAAGA,CAAC,CAACE,SAAF,CAAY,CAAZ,EAAeF,CAAC,CAACD,MAAjB,CAAJ;;AAC3B,UAAIC,CAAC,CAACG,OAAF,CAAUR,MAAV,KAAqB,CAAzB,EACE,OAAO9B,IAAI,CAACC,KAAL,CAAWkC,CAAC,CAACE,SAAF,CAAYP,MAAM,CAACI,MAAnB,EAA2BC,CAAC,CAACD,MAA7B,CAAX,CAAP;AACH;;AACD,WAAO,IAAP;AACD;;AAED,WAASK,WAAT,CAAqBnB,IAArB,EAA2B;AACzBQ,IAAAA,QAAQ,CAACC,MAAT,GACET,IAAI,GAAG,mDADT;AAED;;AAED,SAAO,CAACvB,KAAD,EAAQiB,sBAAR,CAAP;AACD;;AAED,eAAepB,aAAf","sourcesContent":["import { useState, useEffect } from \"react\";\n\nfunction useLocalState<T>(key: string, defaultValue: T) {\n  const [value, setValue] = useState(() => {\n    if (process.browser) {\n      const storedValue = JSON.parse(localStorage.getItem(key));\n      if (!storedValue) {\n        return defaultValue;\n      }\n      return storedValue === null ? defaultValue : storedValue;\n    } else {\n      return defaultValue;\n    }\n  });\n\n  useEffect(() => {\n    const listener = (e) => {\n      if (e.storageArea === localStorage && e.key === key) {\n        setValue(JSON.parse(e.newValue));\n        console.log(getCookie(\"\"))\n      }\n    };\n    window.addEventListener(\"storage\", listener);\n\n    return () => {\n      window.removeEventListener(\"storage\", listener);\n    };\n  }, [key]);\n\n  const setValueInLocalStorage = (newValue) => {\n    setValue((currentValue) => {\n      const result =\n        typeof newValue === \"function\" ? newValue(currentValue) : newValue;\n      localStorage.setItem(key, JSON.stringify(result));\n      return result;\n    });\n\n    setCookie(key, newValue);\n  };\n\n  useEffect(() => {\n    const storedValue = JSON.parse(localStorage.getItem(key));\n    if (storedValue) {\n      setValueInLocalStorage(storedValue);\n    } else {\n      setValueInLocalStorage(value);\n    }\n  }, []);\n\n  function setCookie(name, value, days = 99999999) {\n    var expires = \"\";\n    if (days) {\n      var date = new Date();\n      date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n      expires = \"; expires=\" + date.toUTCString();\n    }\n    document.cookie =\n      name + \"=\" + (JSON.stringify(value) || \"\") + expires + \"; path=/\";\n  }\n\n  function getCookie(name) {\n    var nameEQ = name + \"=\";\n    var ca = document.cookie.split(\";\");\n    for (var i = 0; i < ca.length; i++) {\n      var c = ca[i];\n      while (c.charAt(0) == \" \") c = c.substring(1, c.length);\n      if (c.indexOf(nameEQ) == 0)\n        return JSON.parse(c.substring(nameEQ.length, c.length));\n    }\n    return null;\n  }\n\n  function eraseCookie(name) {\n    document.cookie =\n      name + \"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;\";\n  }\n\n  return [value, setValueInLocalStorage];\n}\n\nexport default useLocalState;\n"]},"metadata":{},"sourceType":"module"}