{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport Cookies from \"js-cookie\";\nexport default function useLocalState(key, defaultValue) {\n  _s();\n\n  var _useState = useState(function () {\n    if (true) {\n      return getValue(key);\n    }\n  }),\n      value = _useState[0],\n      setValueState = _useState[1];\n\n  useEffect(function () {\n    var listener = function listener(e) {\n      if (e.storageArea === localStorage && e.key === key) {\n        setValueState(JSON.parse(e.newValue));\n      }\n    };\n\n    window.addEventListener(\"storage\", listener);\n\n    if (!isLocalStorageWorking()) {\n      setInterval(function () {\n        if (JSON.stringify(getCookie(key)) != JSON.stringify(value)) {\n          setValueState(getCookie(key));\n        }\n      }, 500);\n    }\n\n    return function () {\n      window.removeEventListener(\"storage\", listener);\n    };\n  }, [key]);\n\n  var setValue = function setValue(newValue) {\n    setValueState(function (currentValue) {\n      var value = null;\n\n      if (typeof newValue === \"function\") {\n        value = newValue(currentValue);\n      } else {\n        value = newValue;\n      }\n\n      if (isLocalStorageWorking()) {\n        localStorage.setItem(key, JSON.stringify(value));\n      } else {\n        setCookie(key, value);\n      }\n\n      return value;\n    });\n  };\n\n  return [value, setValue];\n}\n\n_s(useLocalState, \"PzkA+WywkBhzu0D8FNCg+yfV/iY=\");\n\nvar getValue = function getValue(key) {\n  if (isLocalStorageWorking()) {\n    // return from local storage\n    var value = localStorage.getItem(key);\n    return value ? JSON.parse(value) : value;\n  } // return from cookie;\n\n\n  return getCookie(key);\n};\n\nvar isLocalStorageWorking = function isLocalStorageWorking() {\n  var key = \"local-storage-test\";\n  var value = 19;\n  localStorage.setItem(key, JSON.stringify(value));\n\n  if (JSON.parse(localStorage.getItem(key)) == value) {\n    console.log(\"working\");\n    return true;\n  }\n\n  console.log(\"not working\");\n  return false;\n};\n\nvar setCookie = function setCookie(key, value) {\n  Cookies.set(key ? JSON.stringify(key) : key, value ? JSON.stringify(value) : value);\n};\n\nvar getCookie = function getCookie(key) {\n  var result = Cookies.get(JSON.stringify(key));\n  return result ? JSON.parse(result) : result;\n};","map":{"version":3,"sources":["/home/ishraqkabir/workspace/smartifier-frontend/custom-hooks/useLocalState.ts"],"names":["useState","useEffect","Cookies","useLocalState","key","defaultValue","getValue","value","setValueState","listener","e","storageArea","localStorage","JSON","parse","newValue","window","addEventListener","isLocalStorageWorking","setInterval","stringify","getCookie","removeEventListener","setValue","currentValue","setItem","setCookie","getItem","console","log","set","result","get"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport Cookies from \"js-cookie\";\n\nexport default function useLocalState<T>(key: string, defaultValue: any) {\n  const [value, setValueState] = useState(() => {\n    if (process.browser) {\n      return getValue(key);\n    }\n  });\n\n  useEffect(() => {\n    const listener = (e) => {\n      if (e.storageArea === localStorage && e.key === key) {\n        setValueState(JSON.parse(e.newValue));\n      }\n    };\n    window.addEventListener(\"storage\", listener);\n\n    if (!isLocalStorageWorking()) {\n      setInterval(() => {\n        if (JSON.stringify(getCookie(key)) != JSON.stringify(value)) {\n          setValueState(getCookie(key));\n        }\n      }, 500);\n    }\n\n    return () => {\n      window.removeEventListener(\"storage\", listener);\n    };\n  }, [key]);\n\n  const setValue = (newValue) => {\n    setValueState((currentValue) => {\n      let value = null;\n\n      if (typeof newValue === \"function\") {\n        value = newValue(currentValue);\n      } else {\n        value = newValue;\n      }\n\n      if (isLocalStorageWorking()) {\n        localStorage.setItem(key, JSON.stringify(value));\n      } else {\n        setCookie(key, value);\n      }\n\n      return value;\n    });\n  };\n\n  return [value, setValue];\n}\n\nconst getValue = (key) => {\n  if (isLocalStorageWorking()) {\n    // return from local storage\n    const value = localStorage.getItem(key);\n    return value ? JSON.parse(value) : value;\n  }\n\n  // return from cookie;\n  return getCookie(key);\n};\n\nconst isLocalStorageWorking = (): boolean => {\n  const key = \"local-storage-test\";\n  const value = 19;\n\n  localStorage.setItem(key, JSON.stringify(value));\n\n  if (JSON.parse(localStorage.getItem(key)) == value) {\n    console.log(\"working\");\n    return true;\n  }\n\n  console.log(\"not working\");\n  return false;\n};\n\nconst setCookie = (key, value) => {\n  Cookies.set(\n    key ? JSON.stringify(key) : key,\n    value ? JSON.stringify(value) : value\n  );\n};\n\nconst getCookie = (key) => {\n  const result = Cookies.get(JSON.stringify(key));\n  return result ? JSON.parse(result) : result;\n};"]},"metadata":{},"sourceType":"module"}