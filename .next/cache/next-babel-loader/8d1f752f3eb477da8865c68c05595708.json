{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport React, { useEffect } from \"react\";\nimport axios from \"axios\";\nimport { local_backend_url } from \"../../url\";\nimport useLocalState from \"../../custom-hooks/useLocalState\";\nimport { Box, CircularProgress, LinearProgress, Typography, withStyles } from \"@material-ui/core\";\nimport { useRouter } from \"next/router\";\n\nconst Google = () => {\n  const router = useRouter();\n  const {\n    code\n  } = router.query;\n  const [user, setUser] = useLocalState(\"user\", \"\");\n  useEffect(() => {\n    if (code) {\n      axios({\n        method: \"get\",\n        url: `/api/auth/google?get=user&code=${code}`\n      }).then(res => {\n        const id_token = res.data.user.data.id_token;\n        axios({\n          method: \"GET\",\n          url: `https://oauth2.googleapis.com/tokeninfo?id_token=${id_token}`\n        }).then(response => {\n          const {\n            email,\n            email_verified,\n            at_hash,\n            name,\n            picture\n          } = response.data;\n          axios.post(`${local_backend_url}/api/auth/googleSignIn`, {\n            id_token: id_token,\n            email: email,\n            at_hash: at_hash,\n            email_verified: email_verified === \"true\" ? true : false,\n            name: name,\n            picture: picture\n          }).then(response => {\n            const token = response.data;\n            const user = {\n              email: email,\n              name: name,\n              picture: picture,\n              token: token\n            };\n            setUser(user);\n            window.close(); // router.replace(\"/\");\n          }).catch(error => {\n            setUser(\"\");\n            window.history.back();\n          });\n        }).catch(error => {\n          setUser(\"\");\n          window.history.back();\n        });\n      });\n    }\n  }, [code]);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(LinearProgress, {}), /*#__PURE__*/_jsxs(Container, {\n      children: [/*#__PURE__*/_jsx(Title, {\n        variant: \"h6\",\n        children: \"Please wait while we sign you in...\"\n      }), /*#__PURE__*/_jsx(Title, {\n        children: \"Redirecting you to smartifier.org...\"\n      }), /*#__PURE__*/_jsx(CircularProgress, {})]\n    })]\n  });\n};\n\nexport default Google;\nconst Container = withStyles({\n  root: {\n    width: \"100vw\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  }\n})(Box);\nconst Title = withStyles({\n  root: {\n    textAlign: \"center\",\n    marginTop: 30,\n    marginBottom: 10\n  }\n})(Typography);","map":null,"metadata":{},"sourceType":"module"}